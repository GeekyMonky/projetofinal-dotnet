@page "/product-details/{id:int}"
@using ProjetoFinal.Shared
@inject IApiService ApiService

<h3>Product Details</h3>

@if (_loading)
{
    <div class="d-flex justify-content-center my-4">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
}
else if (Product == null)
{
    <div class="alert alert-danger">Product not found.</div>
}
else
{
    <table class="table table-bordered table-striped">
        <thead class="table-light">
            <tr>
                <th scope="col">Property</th>
                <th scope="col">Value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Name</td>
                <td>@Product.Name</td>
            </tr>
            <tr>
                <td>Description</td>
                <td>@Product.Description</td>
            </tr>
            <tr>
                <td>Price</td>
                <td>@Product.Price</td>
            </tr>
            <tr>
                <td>Stock Quantity</td>
                <td>@Product.StockQuantity</td>
            </tr>
            <tr>
                <td>Category</td>
                <td>@Product.Category?.Name</td>
            </tr>
            <tr>
                <td>Images</td>
                <td>
                    @if (Product.Images != null && Product.Images.Any())
                    {
                        <div class="d-flex flex-wrap gap-2">
                            @foreach (var img in Product.Images)
                            {
                                <img src="@img.Url" alt="@Product.Name" width="150" height="150" class="img-thumbnail" />
                            }
                        </div>
                    }
                    else
                    {
                        <span>No images available.</span>
                    }
                </td>
            </tr>
        </tbody>
    </table>
}

@code {
    [Parameter]
    public int id { get; set; }

    private Product? Product;
    private bool _loading = true;

    protected override async Task OnInitializedAsync()
    {
        Product = await ApiService.GetProductAsync(id);
        _loading = false;
    }
}